version: 2

models:

  - name: int_stock_returns
    tests:
      - unique:
          column_name: ["ticker", "trading_date"]

      - not_null: ticker
      - not_null: trading_date
      - not_null: daily_return

      - dbt_utils.accepted_range:
          column_name: daily_return
          min_value: -1
          max_value: 5   # extreme outlier guardrail

  - name: int_growth_factors
    tests:
      - unique:
          column_name: ticker

      - not_null: ticker
      - not_null: revenue_growth_yoy
      - not_null: earnings_growth_yoy

      - dbt_utils.accepted_range:
          column_name: revenue_growth_yoy
          min_value: -1
          max_value: 10

      - dbt_utils.accepted_range:
          column_name: earnings_growth_yoy
          min_value: -1
          max_value: 10

  - name: int_sector_summary
    tests:
      - unique: sector
      - not_null: sector
      - dbt_utils.accepted_range:
          column_name: avg_market_cap
          min_value: 0
